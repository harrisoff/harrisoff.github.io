(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7df6bacf"],{"1b95":function(t,e,i){"use strict";i.r(e),i("4de4"),i("4160"),i("caad"),i("d81d"),i("d3b7"),i("2532"),i("3ca3"),i("159b"),i("ddb0");var l=i("f332"),o=i("7cd0"),a={name:"",components:{},filters:{},mixins:[],props:[],data:function(){return{dialogType:"add",isDialogVisible:!1,bookletList:[],isLoading:!1,cacheTitle:"",bookletId:"",bookletTitle:"",leftList:[],rightList:[]}},computed:{},watch:{},beforeCreate:function(){},created:function(){this.getBookletList()},mounted:function(){},beforeUpdate:function(){},methods:{beforeSubmitBooklet:function(){var t=this;this.bookletTitle&&this.$confirm("确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){var e=t.rightList;if("add"===t.dialogType){var i={article_id:[],title:t.bookletTitle,type:"booklet"};Object(o.b)(i).then((function(i){var o=i.id_list[0];e.length?Object(l.c)(e,o,t.bookletTitle).then((function(e){t.$success("添加成功"),t.isDialogVisible=!1,t.getBookletList()})).catch(t.$error):(t.$success("添加成功"),t.isDialogVisible=!1,t.getBookletList())})).catch(t.$error)}else{var a=[];e.length&&a.push(Object(l.c)(e,t.bookletId,t.bookletTitle));var n=t.leftList.filter((function(t){return!e.includes(t.key)})).map((function(t){return t.key}));if(n.length&&a.push(Object(l.c)(n,"","")),t.cacheTitle!==t.bookletTitle){var s={title:t.bookletTitle};a.push(Object(o.c)(t.bookletId,s))}Promise.all(a).then((function(){t.$success("修改成功"),t.isDialogVisible=!1,t.getBookletList()})).catch(t.$error)}}))},getBookletList:function(){var t=this;this.isLoading=!0,Object(o.e)().then((function(e){var i=e.data;t.bookletList=i})).catch(this.$error).then((function(e){t.isLoading=!1}))},getArticles:function(){var t=this;Object(l.a)().then((function(e){e.forEach((function(e){var i=e.bookId,l=e.realId,o=e.title;"add"===t.dialogType?""===i&&t.leftList.push({key:l,label:o}):""!==i&&i!==t.bookletId||(t.leftList.push({key:l,label:o}),i===t.bookletId&&t.rightList.push(l))}))})).catch(this.$error)},handleShowDialog:function(t,e){if(this.dialogType=t,this.leftList=[],this.rightList=[],"add"===t)this.bookletTitle="";else{var i=e.title,l=e._id;this.bookletId=l,this.bookletTitle=i,this.cacheTitle=i}this.getArticles(),this.isDialogVisible=!0}}},n=(i("e5ed"),i("2877")),s=Object(n.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"view-articles-booklets"},[i("div",[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleShowDialog("add")}}},[t._v("新增")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],attrs:{data:t.bookletList}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-table",{attrs:{data:e.row.articles}},[i("el-table-column",{attrs:{type:"index",label:"#"}}),i("el-table-column",{attrs:{prop:"title",label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("a",{attrs:{href:e.row.url}},[t._v(t._s(e.row.title))])]}}],null,!0)}),i("el-table-column",{attrs:{prop:"digest",label:"简介"}})],1)]}}])}),i("el-table-column",{attrs:{prop:"title",label:"标题"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.handleShowDialog("edit",e.row)}}},[t._v("修改")])]}}])})],1),i("el-dialog",{attrs:{title:"add"===t.dialogType?"新增":"编辑",visible:t.isDialogVisible,"before-close":function(){return t.isDialogVisible=!1}}},[i("el-input",{attrs:{placeholder:"标题"},model:{value:t.bookletTitle,callback:function(e){t.bookletTitle=e},expression:"bookletTitle"}}),i("el-transfer",{attrs:{data:t.leftList},model:{value:t.rightList,callback:function(e){t.rightList=e},expression:"rightList"}}),i("div",{staticStyle:{"text-align":"right","margin-top":"20px"}},[i("el-button",{attrs:{type:"primary"},on:{click:t.beforeSubmitBooklet}},[t._v("提交")])],1)],1)],1)}),[],!1,null,null,null);e.default=s.exports},2587:function(t,e,i){},e5ed:function(t,e,i){"use strict";var l=i("2587");i.n(l).a}}]);